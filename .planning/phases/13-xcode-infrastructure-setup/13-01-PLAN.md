---
phase: 13-xcode-infrastructure-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png
  - Configuration/README.md
autonomous: true
requirements:
  - INFRA-02

must_haves:
  truths:
    - "App icon is opaque RGB PNG without alpha channel"
    - "Asset catalog contains 1024x1024 icon meeting App Store requirements"
    - "Configuration directory exists for Xcode-specific files"
  artifacts:
    - path: "Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png"
      provides: "1024x1024 opaque app icon"
      min_lines: 0
    - path: "Configuration/"
      provides: "Directory for entitlements and Xcode-managed Info.plist"
      min_lines: 0
  key_links:
    - from: "Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png"
      to: "App Store submission"
      via: "Asset catalog validation"
      pattern: "hasAlpha: no"
---

<objective>
Prepare asset catalog and project structure for Xcode integration.

Purpose: Fix App Store icon requirements (remove alpha channel) and establish directory structure for Xcode configuration files before creating the project.
Output: Opaque app icon meeting App Store requirements, Configuration/ directory for entitlements and Info.plist
</objective>

<execution_context>
@/Users/keith/.claude/get-shit-done/workflows/execute-plan.md
@/Users/keith/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13-xcode-infrastructure-setup/13-RESEARCH.md

@Assets.xcassets/AppIcon.appiconset/Contents.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove alpha channel from app icon</name>
  <files>Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png</files>
  <action>
    Remove alpha channel from icon_512x512@2x.png (1024x1024) to meet App Store requirement for opaque PNG.

    Steps:
    1. Verify current alpha status: `sips -g hasAlpha Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png`
    2. Convert to opaque RGB: `sips -s format png --setProperty formatOptions best --deleteColorManagementProperties Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png`
    3. Verify conversion: `sips -g hasAlpha Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png` should show "hasAlpha: no"

    Why: App Store Connect validation fails with "icon contains transparency" for RGBA icons. Must be opaque RGB.

    Research reference: RESEARCH.md "Pitfall 1: Asset Catalog Icon Contains Alpha Channel"
  </action>
  <verify>
    `sips -g hasAlpha Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png` returns "hasAlpha: no"
  </verify>
  <done>
    icon_512x512@2x.png is opaque RGB PNG without alpha channel, ready for App Store submission
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Configuration directory structure</name>
  <files>Configuration/README.md</files>
  <action>
    Create Configuration/ directory to hold Xcode-specific files (entitlements and Info.plist).

    Steps:
    1. Create directory: `mkdir -p Configuration`
    2. Create README documenting purpose:
       - Directory holds Xcode project configuration files
       - PingScope-AppStore.entitlements (Plan 02)
       - PingScope-DeveloperID.entitlements (Plan 02)
       - Info.plist (migrated from root in Plan 02)
       - Package.swift remains source of truth for code

    Why: Separates Xcode infrastructure from SPM source code. Matches recommended project structure from research.

    Research reference: RESEARCH.md "Pattern 1: Xcode Project Wrapping Local SPM Package"
  </action>
  <verify>
    `ls -la Configuration/README.md` shows file exists
  </verify>
  <done>
    Configuration/ directory exists with README documenting its purpose for Xcode files
  </done>
</task>

</tasks>

<verification>
- Icon has no alpha channel: `sips -g hasAlpha Assets.xcassets/AppIcon.appiconset/icon_512x512@2x.png` returns "hasAlpha: no"
- Configuration directory exists: `ls -d Configuration/`
- README documents purpose: `cat Configuration/README.md`
</verification>

<success_criteria>
- icon_512x512@2x.png is opaque RGB format meeting App Store requirements
- Configuration/ directory exists and is ready to receive entitlement files and Info.plist
- Structure matches research-recommended pattern for Xcode + SPM hybrid
</success_criteria>

<output>
After completion, create `.planning/phases/13-xcode-infrastructure-setup/13-01-SUMMARY.md`
</output>
