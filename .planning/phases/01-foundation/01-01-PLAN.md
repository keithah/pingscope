---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Package.swift
  - Sources/PingMonitor/PingMonitorApp.swift
  - Sources/PingMonitor/Models/PingResult.swift
  - Sources/PingMonitor/Models/Host.swift
  - Sources/PingMonitor/Models/PingError.swift
autonomous: true

must_haves:
  truths:
    - "Project compiles with swift build"
    - "PingResult can represent success with latency, timeout, and connection failure"
    - "Host type captures address, port, protocol, and timeout configuration"
    - "All types are Sendable for actor isolation"
  artifacts:
    - path: "Package.swift"
      provides: "Swift package manifest"
      contains: "macOS(.v13)"
    - path: "Sources/PingMonitor/Models/PingResult.swift"
      provides: "Ping result type with latency measurement"
      contains: "struct PingResult"
    - path: "Sources/PingMonitor/Models/Host.swift"
      provides: "Host configuration model"
      contains: "struct Host"
    - path: "Sources/PingMonitor/Models/PingError.swift"
      provides: "Ping error enumeration"
      contains: "enum PingError"
  key_links:
    - from: "PingResult.swift"
      to: "PingError"
      via: "error property reference"
      pattern: "PingError"
    - from: "Host.swift"
      to: "NWParameters"
      via: "protocol property"
      pattern: "NWParameters|tcp|udp"
---

<objective>
Create Swift package structure and core data models for PingMonitor.

Purpose: Establish the foundation for the ping monitoring service with type-safe models that work with Swift Concurrency. The models must be Sendable to work with actors and support measuring TCP/UDP latency.

Output: Compilable Swift package with PingResult, Host, and PingError types.
</objective>

<execution_context>
@/Users/keith/.claude/get-shit-done/workflows/execute-plan.md
@/Users/keith/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-CONTEXT.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Swift Package Structure</name>
  <files>
    - Package.swift
    - Sources/PingMonitor/PingMonitorApp.swift
  </files>
  <action>
Create a Swift package for the PingMonitor app:

1. Create Package.swift:
   - Name: "PingMonitor"
   - Platforms: macOS 13.0+ (Ventura) - required for modern SwiftUI and WidgetKit
   - Products: executable named "PingMonitor"
   - No external dependencies (using only Apple frameworks)

2. Create minimal app entry point Sources/PingMonitor/PingMonitorApp.swift:
   - Import SwiftUI
   - Create @main App struct with empty WindowGroup
   - This is a placeholder - real UI comes in Phase 2

3. Create directory structure:
   - Sources/PingMonitor/Models/
   - Sources/PingMonitor/Services/
   - Sources/PingMonitor/Utilities/
   - Tests/PingMonitorTests/

Use Swift 5.9+ features. Enable strict concurrency checking in Package.swift with swiftSettings.
  </action>
  <verify>
Run `swift build` in project root - should compile without errors.
Run `swift package describe` - should show PingMonitor executable target.
  </verify>
  <done>
Package.swift exists with macOS 13+ platform requirement. Basic app entry point compiles. Directory structure created for Models, Services, Utilities, and Tests.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Core Data Models</name>
  <files>
    - Sources/PingMonitor/Models/PingResult.swift
    - Sources/PingMonitor/Models/Host.swift
    - Sources/PingMonitor/Models/PingError.swift
  </files>
  <action>
Create the three core model types needed for ping operations:

1. PingError.swift - Error enumeration:
   ```swift
   enum PingError: Error, Sendable, Equatable {
       case timeout
       case connectionFailed(String)  // String message, not Error (for Sendable)
       case cancelled
       case invalidHost
   }
   ```

2. PingResult.swift - Result of a single ping:
   ```swift
   struct PingResult: Sendable, Equatable {
       let host: String
       let port: UInt16
       let timestamp: Date
       let latency: Duration?       // nil if failed
       let error: PingError?        // nil if success

       var isSuccess: Bool { latency != nil && error == nil }
       var isTimeout: Bool { error == .timeout }

       // Factory methods for clean construction
       static func success(host: String, port: UInt16, latency: Duration) -> PingResult
       static func failure(host: String, port: UInt16, error: PingError) -> PingResult
   }
   ```

3. Host.swift - Host configuration:
   ```swift
   import Network

   struct Host: Sendable, Identifiable, Equatable {
       let id: UUID
       let name: String             // Display name (e.g., "Google DNS")
       let address: String          // IP or hostname
       let port: UInt16             // Default: 443 for TCP, 53 for DNS
       let protocolType: ProtocolType
       let timeout: Duration        // Default: 3 seconds (per user decision)
       let isDefault: Bool          // Default hosts cannot be deleted

       enum ProtocolType: String, Sendable, CaseIterable {
           case tcp
           case udp
       }

       // Default hosts from PROJECT.md requirements
       static let googleDNS = Host(name: "Google DNS", address: "8.8.8.8", port: 443, protocolType: .tcp)
       static let cloudflareDNS = Host(name: "Cloudflare", address: "1.1.1.1", port: 443, protocolType: .tcp)
   }
   ```

All types must be:
- Sendable (for actor isolation)
- Equatable (for testing and state comparison)
- Using Duration (not TimeInterval) for type-safe time handling
  </action>
  <verify>
Run `swift build` - all models compile.
Run `swift test` (will have no tests yet, but should not error on model compilation).
Check that types conform to Sendable by adding to an actor property (compiler will error if not Sendable).
  </verify>
  <done>
PingResult, Host, and PingError types exist and compile. All are Sendable and Equatable. Host includes static factory properties for default hosts. PingResult uses Duration for latency measurement.
  </done>
</task>

</tasks>

<verification>
1. `swift build` completes successfully
2. `swift package describe` shows correct structure
3. Directory structure exists: Models/, Services/, Utilities/, Tests/
4. All model files compile and are importable
</verification>

<success_criteria>
- Package.swift configured for macOS 13.0+
- PingResult captures success/failure with Duration latency
- Host captures address, port, protocol, timeout configuration
- PingError covers timeout, connection failure, cancellation
- All types are Sendable for actor compatibility
- Project compiles with `swift build`
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
