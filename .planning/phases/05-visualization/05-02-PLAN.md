---
phase: 05-visualization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - Sources/PingScope/Views/DisplayGraphView.swift
autonomous: true

must_haves:
  truths:
    - "Latency graph renders an Activity Monitor-like line with a gradient fill under it"
    - "Graph shows visible point markers representing individual samples"
    - "Graph remains readable across sparse and dense data (1min through 1hour)"
  artifacts:
    - path: "Sources/PingScope/Views/DisplayGraphView.swift"
      provides: "Graph rendering (grid, axes, line, gradient fill, point markers)"
      contains: "Canvas|Path|LinearGradient"
  key_links:
    - from: "Sources/PingScope/Views/DisplayGraphView.swift"
      to: "Sources/PingScope/ViewModels/DisplayViewModel.swift"
      via: "GraphPoint input drives axis, line, fill, markers"
      pattern: "DisplayViewModel\.GraphPoint"
---

<objective>
Polish the latency graph to match macOS Activity Monitor styling.

Purpose: Phase 5 is about visualization quality. The graph should feel native and convey trends at a glance via a gradient-filled line chart with clear sample markers.

Output: Updated `DisplayGraphView` with gradient fill, refined grid/background, and point markers that stay performant at 1-hour density.
</objective>

<execution_context>
@/Users/keith/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/keith/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/REQUIREMENTS.md
@.planning/phases/05-visualization/05-CONTEXT.md

@Sources/PingScope/Views/DisplayGraphView.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add gradient fill under the latency line</name>
  <files>Sources/PingScope/Views/DisplayGraphView.swift</files>
  <action>
Implement an "area under the curve" fill:
- Build an area path from the existing line path by closing it down to the chart baseline.
- Fill it with a subtle vertical `LinearGradient` (Activity Monitor feel): stronger near the line, fading toward the bottom.

Constraints:
- Do not add threshold reference lines.
- Keep existing axis labels and grid, but you may refine their colors/opacities to fit the Activity Monitor aesthetic.
  </action>
  <verify>swift test</verify>
  <done>
The graph clearly shows a gradient-filled area under the line in both full mode and screenshot rendering.
  </done>
</task>

<task type="auto">
  <name>Task 2: Ensure data points are visible for individual samples across densities</name>
  <files>Sources/PingScope/Views/DisplayGraphView.swift</files>
  <action>
Update point marker rendering so sample markers remain visible even with 1-hour windows:
- Keep using `Canvas` for performance.
- Render a marker for every sample (no hard cutoff like `<= 60`).
- Dynamically adjust marker radius and opacity based on `points.count` (e.g. smaller + more transparent as density increases) so the line remains readable.

Notes:
- The marker style (dots vs subtle ticks) is up to you, but it must read as "per-sample points".
  </action>
  <verify>swift test</verify>
  <done>
Markers are present for dense series (e.g. hundreds/thousands of points) without overwhelming the chart.
  </done>
</task>

<task type="auto">
  <name>Task 3: Refine background/grid to match Activity Monitor feel</name>
  <files>Sources/PingScope/Views/DisplayGraphView.swift</files>
  <action>
Tune the chart background and grid styling:
- Prefer macOS semantic colors (`NSColor`-backed where appropriate) so the chart looks native in standard light/dark appearances.
- Keep grid subtle; ensure axis labels remain legible.
- If needed, add a very subtle border/inner shadow using SwiftUI primitives (no new dependencies).
  </action>
  <verify>swift test</verify>
  <done>
Graph styling reads as "Activity Monitor-like" (native, subtle grid, clear trend line + fill).
  </done>
</task>

</tasks>

<verification>
- `swift test` passes.
</verification>

<success_criteria>
- Graph shows a gradient fill under the line (VIS-01).
- Graph shows per-sample point markers (VIS-02) and remains readable at 1-hour density.
</success_criteria>

<output>
After completion, create `.planning/phases/05-visualization/05-02-SUMMARY.md`
</output>
