# Milestone v1.0: MVP

**Status:** ✅ SHIPPED 2026-02-17
**Phases:** 1-12
**Total Plans:** 50

## Overview

PingMonitor is a macOS menu bar network monitoring app rewritten from a monolithic implementation to a stable, modular architecture. The roadmap prioritized foundation-first development to eliminate the race conditions and stale connections that plagued the previous implementation. Each phase delivered a complete, verifiable capability building toward a reliable ping monitor that users can trust.

## Phases

### Phase 1: Foundation
**Goal**: Establish correct async patterns and connection lifecycle that prevent the race conditions and stale connections from the previous implementation.
**Depends on**: Nothing (first phase)
**Requirements**: TECH-01, TECH-02, TECH-03, TECH-04, TECH-05, TECH-06, TECH-07
**Plans**: 4 plans

Plans:
- [x] 01-01-PLAN.md — Swift package setup and core data models (PingResult, Host, PingError)
- [x] 01-02-PLAN.md — NWConnection async wrapper and PingService actor with timeout racing
- [x] 01-03-PLAN.md — HostHealthTracker, ConnectionSweeper, and PingScheduler services
- [x] 01-04-PLAN.md — Unit tests for timeout behavior and concurrent handling

### Phase 2: Menu Bar & State
**Goal**: Users see real-time ping status in the menu bar and can interact via left/right click.
**Depends on**: Phase 1
**Requirements**: MENU-01, MENU-02, MENU-03, MENU-04, MENU-05, MENU-06, MENU-07
**Plans**: 4 plans

Plans:
- [x] 02-01-PLAN.md — Menu bar state evaluator, smoothing, and view-model tests
- [x] 02-02-PLAN.md — Status item controller, click routing, context menu, and mode persistence
- [x] 02-03-PLAN.md — Popover view model and SwiftUI popover interface
- [x] 02-04-PLAN.md — App lifecycle wiring, integration smoke tests, and human interaction verification

### Phase 3: Host Monitoring
**Goal**: Users can monitor multiple hosts with configurable ping methods and settings.
**Depends on**: Phase 2
**Requirements**: HOST-01, HOST-02, HOST-03, HOST-04, HOST-05, HOST-06, HOST-07, HOST-08, HOST-09, HOST-10
**Plans**: 9 plans (including 2 gap-closure plans)

Plans:
- [x] 03-01-PLAN.md — Extend Host model with per-host configuration and ping methods
- [x] 03-02-PLAN.md — GatewayDetector service with sysctl gateway lookup and network monitoring
- [x] 03-03-PLAN.md — Update PingService for TCP, UDP, and ICMP-simulated methods
- [x] 03-04-PLAN.md — HostStore actor for CRUD and UserDefaults persistence
- [x] 03-05-PLAN.md — Host list view with selection, indicators, and delete confirmation
- [x] 03-06-PLAN.md — Add/edit host sheet with form validation and test ping
- [x] 03-07-PLAN.md — App integration with multi-host monitoring and gateway detection
- [x] 03-08-PLAN.md — Gap closure: per-host scheduler cadence wiring and tests
- [x] 03-09-PLAN.md — Gap closure: threshold-aware status evaluation wiring and tests

### Phase 4: Display Modes
**Goal**: Users can choose between full and compact views, with optional stay-on-top floating window.
**Depends on**: Phase 3
**Requirements**: DISP-01, DISP-02, DISP-03, DISP-04, DISP-05, DISP-06
**Plans**: 5 plans

Plans:
- [x] 04-01-PLAN.md — Define display-mode persistence contracts and preference store
- [x] 04-02-PLAN.md — Build full/compact display views and shared display view model
- [x] 04-03-PLAN.md — Implement popover/floating coordinator with anchor and drag-handle behavior
- [x] 04-04-PLAN.md — Integrate display mode runtime wiring, settings toggles, and smoke tests
- [x] 04-05-PLAN.md — Human verification checkpoint for DISP-01 through DISP-06

### Phase 5: Visualization
**Goal**: Users can see latency trends via graph and review ping history with statistics.
**Depends on**: Phase 4
**Requirements**: VIS-01, VIS-02, VIS-03, VIS-04, VIS-05, VIS-06, VIS-07
**Plans**: 3 plans

Plans:
- [x] 05-01-PLAN.md — Increase in-session history retention to 3600 samples per host
- [x] 05-02-PLAN.md — Polish graph styling (Activity Monitor-like gradient fill + per-sample markers)
- [x] 05-03-PLAN.md — Human verification checkpoint for visualization polish

### Phase 6: Notifications & Settings
**Goal**: Users receive intelligent alerts and all settings persist across app restarts.
**Depends on**: Phase 5
**Requirements**: NOTF-01, NOTF-02, NOTF-03, NOTF-04, NOTF-05, NOTF-06, NOTF-07, NOTF-08, NOTF-09, NOTF-10, SETT-01, SETT-02, SETT-03, SETT-04, SETT-05, SETT-06
**Plans**: 8 plans (including 2 gap-closure plans)

Plans:
- [x] 06-01-PLAN.md — NotificationService actor, AlertType enum, and NotificationPreferencesStore
- [x] 06-02-PLAN.md — Alert detection logic for all 7 alert types with cooldown
- [x] 06-03-PLAN.md — Per-host notification settings in Host model and add/edit sheet
- [x] 06-04-PLAN.md — Settings TabView with Host, Notification, and Display tabs
- [x] 06-05-PLAN.md — Privacy manifest and app lifecycle notification wiring
- [x] 06-06-PLAN.md — Human verification checkpoint for all Phase 6 requirements
- [x] 06-07-PLAN.md — Gap closure: restore tabbed Settings shell and wire advanced notification controls
- [x] 06-08-PLAN.md — Gap closure: human re-verification of Phase 6 settings truths

### Phase 7: Settings Focus
**Goal**: Settings are reliable, native-feeling, and changes apply immediately across the running app (no restart required).
**Depends on**: Phase 6 (Settings UI + persistence foundation)
**Requirements**: SETT-01, SETT-02, SETT-03, SETT-04, SETT-05, SETT-06
**Plans**: 4 plans

Plans:
- [x] 07-01-PLAN.md — Dedicated settings window + single-window behavior + command wiring
- [x] 07-02-PLAN.md — Use a shared HostStore (no duplicate stores) so Settings updates apply live
- [x] 07-03-PLAN.md — Settings persistence + reload consistency (hosts, display, notifications UI)
- [x] 07-04-PLAN.md — Human verification checkpoint for Settings end-to-end

### Phase 8: Visualization Requirement Reconciliation & Verification
**Goal**: Close milestone visualization gaps by reconciling VIS-01 through VIS-07 with implementation and producing complete verification evidence.
**Depends on**: Phase 7
**Requirements**: VIS-01, VIS-02, VIS-03, VIS-04, VIS-05, VIS-06, VIS-07
**Gap Closure**: Closes audit requirement gaps and missing Phase 5 verification artifact
**Plans**: 1 plan

Plans:
- [x] 08-01-PLAN.md — Reconcile visualization requirements, fill implementation gaps, and produce Phase 5 verification artifact

### Phase 9: Regression Test Wiring Recovery
**Goal**: Restore cross-phase test wiring so automated regression checks compile and run cleanly.
**Depends on**: Phase 8
**Requirements**: Milestone integration closure (test compile baseline)
**Gap Closure**: Closes audit integration gap blocking automated regression verification
**Plans**: 1 plan

Plans:
- [x] 09-01-PLAN.md — Repair stale test references and re-establish compile-green regression baseline

### Phase 10: True ICMP Support
**Goal:** Enable real ICMP ping when running outside App Store sandbox, with automatic detection and graceful UI hiding when sandboxed.
**Depends on**: Phase 9
**Requirements**: HOST-11
**Plans**: 4 plans

Plans:
- [x] 10-01-PLAN.md — SandboxDetector utility and ICMPPacket structures
- [x] 10-02-PLAN.md — ICMPPinger service with non-privileged socket ping
- [x] 10-03-PLAN.md — PingMethod.icmp case, PingService routing, and AddHostSheet filtering
- [x] 10-04-PLAN.md — Human verification checkpoint for ICMP support end-to-end

### Phase 11: Tech Debt Closure
**Goal:** Close non-critical v1.0 tech debt so production wiring and active settings UX are fully aligned with implemented capabilities.
**Depends on:** Phase 10
**Requirements:** Debt closure follow-up from v1.0 milestone audit
**Plans:** 4 plans

Plans:
- [x] 11-01-PLAN.md — Wire ConnectionSweeper into production ping lifecycle with regression coverage
- [x] 11-02-PLAN.md — Add active settings host-level notification override editor and persistence tests
- [x] 11-03-PLAN.md — Remove legacy HostSettingsView and normalize planning summary path conventions
- [x] 11-04-PLAN.md — Run debt-closure verification checks and human acceptance checkpoint

### Phase 12: ICMP Host Persistence + Verification Closure
**Goal:** Close milestone-blocking ICMP host configuration and verification gaps so HOST-11 is fully satisfied end-to-end.
**Depends on:** Phase 11
**Requirements:** HOST-11
**Gap Closure:** Closes v1.0 audit gaps for ICMP host CRUD persistence, flow wiring, and missing Phase 10 verification artifact
**Plans:** 3 plans

Plans:
- [x] 12-01-PLAN.md — Fix ICMP host CRUD persistence validation semantics and add HostStore regression tests
- [x] 12-02-PLAN.md — Add ICMP persistence-to-scheduler integration regression coverage
- [x] 12-03-PLAN.md — Produce Phase 10 verification artifact and close HOST-11 audit/traceability blockers

---

## Milestone Summary

**Key Decisions:**
- Use Swift Concurrency over GCD semaphores to eliminate race conditions
- Modular file structure over single file for maintainability
- Defer widget to v2 to focus on core app stability
- Dual-mode ICMP support: true ICMP when not sandboxed, hidden when sandboxed
- NWConnection instances are created fresh per measurement for reliability
- Host down state requires 3 consecutive failures tracked per host
- Display state persisted as one Codable payload split into shared/full/compact partitions
- Settings window uses dedicated NSWindowController for LSUIElement reliability

**Issues Resolved:**
- False timeout race conditions from semaphore-based async handling
- Stale connections accumulating from improper lifecycle management
- Settings not applying until app restart
- ICMP hosts failing persistence validation due to port semantics

**Technical Debt Incurred:**
- Requirements checklist not fully synchronized with traceability (cosmetic)
- Some legacy path references in older verification docs (cosmetic)

---

*For current project status, see .planning/ROADMAP.md*
